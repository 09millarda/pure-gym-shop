(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{40:function(e,t,a){e.exports=a(61)},55:function(e,t,a){},56:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(26),i=a.n(c),s=a(8),l=a(9),o=a(12),u=a(10),m=a(11),d=a(28),f=a(14);var h=function(e){return r.a.createElement("li",null,r.a.createElement(f.b,{exact:null==e.exact||e.exact,to:e.rootUrl},r.a.createElement(d.a,{icon:e.logo}),r.a.createElement("span",{className:"ml-3"},e.title)))},p=a(20);var b=function(){return r.a.createElement("div",{className:"left side-menu",style:{top:"0px"}},r.a.createElement("div",{style:{position:"relative",overflow:"inherit",width:"auto"}},r.a.createElement("div",{className:"sidebar-inner",style:{overflow:"hidden",width:"auto"}},r.a.createElement("div",{id:"sidebar-menu"},r.a.createElement("ul",null,r.a.createElement("li",{className:"menu-title"},"Store"),r.a.createElement(h,{title:"Store",logo:p.e,rootUrl:"/"}),r.a.createElement(h,{title:"Checkout",logo:p.b,rootUrl:"/checkout"}),r.a.createElement("li",{className:"menu-title"},"Admin"),r.a.createElement(h,{title:"Item Management",logo:p.c,rootUrl:"/item-management",exact:!1}),r.a.createElement(h,{title:"Subset Management",logo:p.d,rootUrl:"/subset-management",exact:!1}),r.a.createElement(h,{title:"Voucher Management",logo:p.f,exact:!1,rootUrl:"/voucher-management"})),r.a.createElement("div",{className:"clearfix"})),r.a.createElement("div",{className:"clearfix"}))))};var v=function(){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("div",{className:"page-title-box"},r.a.createElement("h4",{className:"page-title"},"Pure Gym Store"),r.a.createElement("div",{className:"clearfix"}))))},E=(a(55),a(56),a(22));var g=function(e){return r.a.createElement("div",{className:"col-sm-4"},r.a.createElement("div",{className:"gal-detail thumb"},r.a.createElement("div",{style:{backgroundImage:"url(".concat(e.imgUrl,")"),backgroundRepeat:"no-repeat",width:"100%",height:"300px",backgroundSize:"100% auto"}}),r.a.createElement("h4",{className:"text-center"},e.title),r.a.createElement("p",{className:"text-muted text-center"},"\xa3",e.price.toFixed(2)),r.a.createElement("div",{className:"ga-border"}),r.a.createElement("p",null,e.description),r.a.createElement("button",{className:"btn btn-info float-right mt-2",onClick:function(){return e.addToCart(e.id)}},r.a.createElement(d.a,{icon:p.a}),r.a.createElement("span",{className:"ml-2"},"Add")),r.a.createElement("div",{className:"clearfix"})))},y=a(1),S=a.n(y),x=a(3);var N=function(){switch(window.location.hostname){case"puregymshop.alistairmillard.me":return"/api";default:return"https://localhost:5001/api"}},O=a(6),I=a.n(O);var j=function(e,t){I()({icon:"error",title:e,text:t})},w="FETCH_ALL_LISTINGS",k="FETCHED_ALL_LISTINGS";function C(){return function(){var e=Object(x.a)(S.a.mark(function e(t){var a;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:w}),a="".concat(N(),"/items"),fetch(a).then(function(){var e=Object(x.a)(S.a.mark(function e(a){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.json();case 2:n=e.sent,t({type:k,listings:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("An error occured fetching listings","".concat(e))});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}var F=a(5);a(60);var T=function(){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 text-center"},r.a.createElement("div",{className:"loader"})))},V=a(19),P=a(2),U={items:[]};var A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae:return Object(P.a)({},e,{items:t.cartItems});default:return e}},L={listings:[],isFetchingListings:!1};var B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(P.a)({},e,{isFetchingListings:!0});case k:return Object(P.a)({},e,{isFetchingListings:!1,listings:t.listings});default:return e}},D="UPDATE_NEW_ITEM";var M={description:"",title:"",imageUri:""};var R="FETCH_ALL_VOUCHERS",W="FETCHED_ALL_VOUCHERS";function _(){return function(){var e=Object(x.a)(S.a.mark(function e(t){var a;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:R}),a="".concat(N(),"/vouchers"),fetch(a).then(function(){var e=Object(x.a)(S.a.mark(function e(a){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.json();case 2:n=e.sent,t({type:W,vouchers:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("An error occured fetching vouchers","".concat(e))});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}var q={vouchers:{giftVouchers:[],offerVouchers:[]},isFetchingVouchers:!1};var H="FETCH_ALL_SUBSETS",J="FETCHED_ALL_SUBSETS",G="UPDATE_NEW_SUBSET";function Q(){return function(){var e=Object(x.a)(S.a.mark(function e(t){var a;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:H}),a="".concat(N(),"/subsets"),fetch(a).then(function(){var e=Object(x.a)(S.a.mark(function e(a){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.json();case 2:n=e.sent,t({type:J,subsets:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("Failed to fetch subsets",e)});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}var K={subsets:[],isFetchingSubsets:!1,newSubsetState:{name:"",itemIds:[]}},Y=Object(V.combineReducers)({cartState:A,listingsState:B,newItemState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return Object(P.a)({},e,{title:t.title,unitPrice:t.price,description:t.description,imageUri:t.imageUri});default:return e}},voucherState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return Object(P.a)({},e,{isFetchingVouchers:!0});case W:return Object(P.a)({},e,{isFetchingVouchers:!1,vouchers:t.vouchers});default:return e}},subsetState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return Object(P.a)({},e,{isFetchingSubsets:!0});case J:return Object(P.a)({},e,{isFetchingSubsets:!1,subsets:t.subsets});case G:return Object(P.a)({},e,{newSubsetState:Object(P.a)({},e.newSubsetState,{name:t.name,itemIds:t.itemIds})});default:return e}}}),z=a(38),$=a(39);var X=Object(V.createStore)(Y,Object($.composeWithDevTools)(Object(V.applyMiddleware)(z.a))),Z=a(33),ee="CART_ITEMS_COOKIE";function te(e,t){Z.set(ee,JSON.stringify(e),{expires:t})}var ae="UPDATE_CART_ITEMS";function ne(e){return te(e,7),{type:ae,cartItems:e}}function re(e,t){var a=X.getState().listingsState.listings.find(function(t){return t.itemId===e});if(null==a)return{type:"_default"};var n=X.getState().cartState.items.slice(),r=n.find(function(e){return e.id===a.itemId});return null==r?n.push({id:a.itemId,quantity:t}):r.quantity=t,ne(n)}var ce=function(e){return r.a.createElement("ul",{className:"nav nav-tabs tabs-bordered"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link active"},e.title)))};var ie=Object(F.b)(function(e){return{isFetchingListings:e.listingsState.isFetchingListings,listings:e.listingsState.listings}},function(e){return{fetchAllListings:function(){return e(C())},addToCart:function(t){return e(function(e){var t=X.getState().cartState.items.find(function(t){return t.id===e});return re(e,null==t?1:t.quantity+1)}(t))}}})(function(e){function t(t){e.addToCart(t)}return Object(n.useEffect)(function(){e.fetchAllListings()},[]),r.a.createElement("div",{className:"card-box"},r.a.createElement(ce,{title:"LISTINGS"}),r.a.createElement("div",{className:"row"},e.listings.map(function(e,a){return r.a.createElement(g,{key:a,description:e.description,imgUrl:e.imageUri,price:e.price,title:e.name,addToCart:t,id:e.itemId})}),0===e.listings.length&&!e.isFetchingListings&&r.a.createElement("p",{className:"col-12 mt-3"},"No Listings"),e.isFetchingListings&&r.a.createElement("div",{className:"col-12"},r.a.createElement(T,null))))}),se=a(13);var le=function(e){var t,a,c=Object(n.useState)(e.quantity.toString()),i=Object(se.a)(c,2),s=i[0],l=i[1];return Object(n.useEffect)(function(){l(e.quantity.toString())},[e.quantity]),r.a.createElement("tr",null,r.a.createElement("td",null,e.title),r.a.createElement("td",null,!e.readonly&&r.a.createElement("input",{type:"number",step:1,min:1,className:"form-control",style:{maxWidth:"70px"},value:s,onChange:function(e){return l(e.target.value)},onBlur:function(t){var a=t.target.validity.valid&&t.target.value.length>0?parseInt(t.target.value,10):1;e.updateCartListingQuantity&&e.updateCartListingQuantity(e.id,a)},pattern:"[0-9]+"}),e.readonly&&s),r.a.createElement("td",null,"\xa3",e.unitPrice),r.a.createElement("td",null,"\xa3",(t=e.unitPrice,a=e.quantity,parseFloat((t*a).toFixed(2)))),!e.readonly&&r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-link",style:{padding:"0px"},onClick:function(){return e.removeFromCart?e.removeFromCart(e.id):null}},"Remove")))};var oe=function(e){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"table-container table-responsive mt-3"},r.a.createElement("table",{className:"table table-hover"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Item"),r.a.createElement("th",null,"Quantity"),r.a.createElement("th",null,"Unit Cost"),r.a.createElement("th",null,"Total"),!e.readonly&&r.a.createElement("th",null))),r.a.createElement("tbody",null,function(t,a){var n=[];return t.forEach(function(t,c){var i=a.find(function(e){return e.itemId===t.id});null!=i&&n.push(r.a.createElement(le,{id:i.itemId,key:c,quantity:t.quantity,removeFromCart:e.removeFromCart,title:i.name,unitPrice:i.price,updateCartListingQuantity:e.updateCartListingQuantity,readonly:e.readonly}))}),n}(e.items,e.listings),(0===e.items.length||0===e.listings.length)&&!e.isFetching&&r.a.createElement("tr",null,r.a.createElement("td",{colSpan:e.readonly?5:4},"No items in cart")),e.isFetching&&r.a.createElement("tr",null,r.a.createElement("td",{colSpan:e.readonly?5:4},r.a.createElement(T,null))))))))};var ue=Object(F.b)(function(e){return{items:e.cartState.items,listings:e.listingsState.listings}},function(e){return{removeItemsWithId:function(t){return e(function(e){return ne(X.getState().cartState.items.slice().filter(function(t){return t.id!==e}))}(t))},alterItemQuantity:function(t,a){return e(re(t,a))}}})(function(e){return r.a.createElement("div",{className:"card-box"},r.a.createElement(ce,{title:"SHOPPING CART"}),r.a.createElement(oe,{items:e.items,listings:e.listings,removeFromCart:function(t){e.removeItemsWithId(t)},updateCartListingQuantity:function(t,a){e.alterItemQuantity(t,a)},readonly:!1}),e.items.length>0&&r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("p",{className:"text-right"},r.a.createElement("b",null,"Basket Total:")," \xa3",function(e,t){var a=0;return e.forEach(function(e){var n=t.find(function(t){return t.itemId===e.id});null!=n&&(a+=n.price*e.quantity)}),a}(e.items,e.listings).toFixed(2)),r.a.createElement("p",{className:"text-right"},r.a.createElement(f.a,{to:"/checkout",className:"btn btn-info"},"Checkout")))))});var me=function(){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-7 col-xl-8"},r.a.createElement(ie,null)),r.a.createElement("div",{className:"col-lg-5 col-xl-4"},r.a.createElement(ue,null)))};var de=function(e){var t=Object(n.useState)([]),a=Object(se.a)(t,2),c=a[0],i=a[1],s=Object(n.useState)(""),l=Object(se.a)(s,2),o=l[0],u=l[1],m=Object(n.useState)(""),d=Object(se.a)(m,2),f=d[0],h=d[1];function p(){return(p=Object(x.a)(S.a.mark(function e(t){var a;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),0!==o.length){e.next=4;break}return h("Code must be between 1 and 20 characters"),e.abrupt("return");case 4:if(-1===c.indexOf(o)){e.next=7;break}return h("A voucher with this code has already been applied"),e.abrupt("return");case 7:(a=c.slice()).push(o),b(a);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function b(e){return v.apply(this,arguments)}function v(){return(v=Object(x.a)(S.a.mark(function t(a){var n;return S.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n="".concat(N(),"/vouchers/apply"),fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({codes:a,itemIdQuantities:e.itemIdQuantities.map(function(e){return{itemId:e.id,quantity:e.quantity}})})}).then(function(){var t=Object(x.a)(S.a.mark(function t(n){var r,c;return S.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(200!==n.status){t.next=9;break}return t.next=3,n.json();case 3:r=t.sent,e.updateAppliedVouchers(r),i(a),u(""),t.next=13;break;case 9:return t.next=11,n.text();case 11:c=t.sent,j("Failed to apply voucher",c);case 13:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){j("Failed to apply voucher",e)});case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}function E(){return(E=Object(x.a)(S.a.mark(function t(){return S.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b([]);case 2:i([]),h(""),e.updateAppliedVouchers([]);case 5:case"end":return t.stop()}},t)}))).apply(this,arguments)}return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("form",{role:"form",onSubmit:function(e){return p.apply(this,arguments)}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Enter Voucher Code"),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{type:"text",className:"form-control",style:{maxWidth:"250px"},value:o,onChange:function(e){u(e.target.value),h("")}}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{className:"btn btn-info"},"Submit"))),f.length>0&&r.a.createElement("p",{className:"text-danger font-13"},f)))),r.a.createElement("div",{className:"col-12"},r.a.createElement("button",{className:"btn",onClick:function(){return E.apply(this,arguments)}},"Clear Vouchers")))};var fe=Object(F.b)(function(e){return{cartItems:e.cartState.items}})(function(e){var t=Object(n.useState)([]),a=Object(se.a)(t,2),c=a[0],i=a[1],s=Object(n.useState)(!1),l=Object(se.a)(s,2),o=l[0],u=l[1],m=Object(n.useState)([]),d=Object(se.a)(m,2),f=d[0],h=d[1];function p(){return(p=Object(x.a)(S.a.mark(function t(){var a,n;return S.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:u(!0),a=e.cartItems.map(function(e){return e.id}),n="".concat(N(),"/items/byIds?csvItemIds=").concat(a.join(",")),fetch(n).then(function(){var e=Object(x.a)(S.a.mark(function e(t){var a;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:a=e.sent,i(a);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("An error occured fetching listings",e)}).finally(function(){u(!1)});case 4:case"end":return t.stop()}},t)}))).apply(this,arguments)}function b(e,t){var a=0;return e.forEach(function(e){var n=t.find(function(t){return t.itemId===e.id});null!=n&&(a+=n.price*e.quantity)}),a}function v(e,t){return e-t.reduce(function(e,t){return e+t.discount},0)}function E(e,t){var a=t.filter(function(t){return"Voucher"===t.itemType&&null!=e.find(function(e){return e.id===t.itemId})}),n=[],r=!0,c=!1,i=void 0;try{for(var s,l=function(){var t=s.value,a=e.find(function(e){return e.id===t.itemId});if(null==a)return"continue";for(var r=0;r<a.quantity;r++)n.push({value:t.price,code:"",voucherType:"Voucher",voucherId:-1})},o=a[Symbol.iterator]();!(r=(s=o.next()).done);r=!0)l()}catch(u){c=!0,i=u}finally{try{r||null==o.return||o.return()}finally{if(c)throw i}}return n}function g(){return(g=Object(x.a)(S.a.mark(function t(){var a;return S.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a="".concat(N(),"/vouchers/gift"),fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({giftVouchers:E(e.cartItems,c).map(function(e){return{value:e.value}})})}).then(function(){var t=Object(x.a)(S.a.mark(function t(a){var n,r;return S.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.text();case 2:n=t.sent,r=v(b(e.cartItems,c),f).toFixed(2),I()({title:"You spent \xa3".concat(r),icon:"success",text:n}).then(function(){te([],7),window.location.href="/"});case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){j("An error occured fetching listings",e)}).finally(function(){u(!1)});case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}return Object(n.useEffect)(function(){!function(){p.apply(this,arguments)}()},[e.cartItems]),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"card-box"},r.a.createElement(ce,{title:"CHECKOUT"}),r.a.createElement(oe,{items:e.cartItems,listings:c,readonly:!0,isFetching:o}),!o&&c.length>0&&r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-6"},r.a.createElement(de,{itemIdQuantities:e.cartItems.filter(function(e){return null!=c.find(function(t){return t.itemId===e.id})}),updateAppliedVouchers:h})),r.a.createElement("div",{className:"col-6"},r.a.createElement("p",{className:"text-right"},"Basket Total: ",r.a.createElement("b",null,"\xa3",b(e.cartItems,c).toFixed(2))),r.a.createElement("div",null,r.a.createElement("table",{className:"table table-sm float-right",style:{maxWidth:"300px",margin:"0px"}},r.a.createElement("tbody",null,f.map(function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.description),r.a.createElement("td",null,r.a.createElement("b",null,"- \xa3",e.discount)))}))),r.a.createElement("div",{className:"clearfix"})),r.a.createElement("hr",null),r.a.createElement("p",{className:"text-right"},"Invoice Total: ",r.a.createElement("b",null,"\xa3",v(b(e.cartItems,c),f).toFixed(2))),r.a.createElement("button",{className:"btn btn-success mt-3 float-right",onClick:function(){return g.apply(this,arguments)}},"Buy Now"))))))}),he=a(15),pe=Object(he.a)();function be(e){return r.a.createElement("tr",{onClick:function(){return pe.push("/item-management/edit/".concat(e.itemId))},style:{cursor:"pointer"}},r.a.createElement("td",null,e.itemId),r.a.createElement("td",null,e.title),r.a.createElement("td",null,e.price.toFixed(2)))}var ve=function(e){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"table-responsive mt-3"},r.a.createElement("table",{className:"table table-hover"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Item Id"),r.a.createElement("th",null,"Title"),r.a.createElement("th",null,"Unit Price (\xa3)"))),r.a.createElement("tbody",null,e.items.map(function(e,t){return r.a.createElement(be,{itemId:e.itemId,key:t,price:e.price,title:e.name})}))))))},Ee=a(18),ge=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).validateForm=function(){var e=!0;return a.setState({titleError:"",priceError:"",descriptionError:"",imageError:""}),(0===a.state.form.title.length||a.state.form.title.length>50)&&(a.setState({titleError:"Title must be between 1 and 50 characters"}),e=!1),(0===a.state.form.description.length||a.state.form.description.length>255)&&(a.setState({descriptionError:"Description must be between 1 and 255 characters"}),e=!1),parseFloat(a.state.form.price)<0&&(a.setState({priceError:"Price must be 0 or greater"}),e=!1),0===a.state.form.imageUri.length&&(a.setState({imageError:"You must upload an image"}),e=!1),e},a.clearImage=function(e){e.preventDefault(),a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{imageUri:""}),imageError:""}))},a.updateImage=function(e){var t=e.target.files?e.target.files[0]:void 0;if(null!=t&&(t.name.includes(".jpg")||t.name.includes(".png")||t.name.includes(".jpeg"))){var n=new FileReader;n.readAsDataURL(t),n.onload=function(){var e=n.result;a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{imageUri:e}),imageError:""})),a.props.formChanged(a.props.form.title,a.props.form.description,a.props.form.unitPrice,e)},n.onerror=function(){a.setState(Object(P.a)({},a.state,{imageError:"Unsupported media. Try a jpg or png file"}))}}else a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{imageUri:""}),imageError:"Unsupported media type. Allowed types or .jpg and .png"})),e.target.value=""},a.updateForm=function(){a.props.formChanged(a.state.form.title,a.state.form.description,parseFloat(a.state.form.price),a.state.form.imageUri)},a.onBlurPrice=function(e){var t=(e.target.validity.valid&&e.target.value.length>0?parseFloat(e.target.value):0).toFixed(2);a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{price:t}),priceError:""}))},a.updatePrice=function(e){a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{price:e.target.value}),priceError:""}))},a.updateTitle=function(e){a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{title:e.target.value}),titleError:""}))},a.updateDescription=function(e){a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{description:e.target.value}),descriptionError:""}))},a.state={form:{description:e.form.description,price:e.form.unitPrice.toString(),title:e.form.title,imageUri:e.form.imageUri},descriptionError:"",priceError:"",titleError:"",imageError:""},a.setState.bind(Object(Ee.a)(Object(Ee.a)(a))),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.props.form.itemId!==e.form.itemId&&this.setState({form:{description:e.form.description,imageUri:e.form.imageUri,price:e.form.unitPrice.toString(),title:e.form.title},descriptionError:"",imageError:"",priceError:"",titleError:""})}},{key:"render",value:function(){return r.a.createElement("form",{className:"mt-3",onBlur:this.updateForm},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("label",null,"Title *"),r.a.createElement("input",{type:"text",className:"form-control",maxLength:50,value:this.state.form.title,onChange:this.updateTitle,readOnly:this.props.readonly}),this.state.titleError.length>0&&r.a.createElement("p",{className:"text-danger font-13 mb-0"},this.state.titleError)),r.a.createElement("div",{className:"col-md-6"},r.a.createElement("label",null,"Unit Price *"),r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},"\xa3")),r.a.createElement("input",{type:"number",className:"form-control",accept:"\\d*\\.?\\d*",min:0,step:"any",value:this.state.form.price,onChange:this.updatePrice,onBlur:this.onBlurPrice,readOnly:this.props.readonly}),this.state.priceError.length>0&&r.a.createElement("p",{className:"text-danger font-13 mb-0"},this.state.priceError)))),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-12"},r.a.createElement("label",null,"Image"),r.a.createElement("br",null),!this.props.readonly&&r.a.createElement(r.a.Fragment,null,this.state.form.imageUri.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn btn-default",onClick:this.clearImage},"Clear Image"),r.a.createElement("br",null)),0===this.state.form.imageUri.length&&r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"file",className:"form-control",multiple:!1,accept:"image/png,image/jpeg,image/jpg",onChange:this.updateImage,readOnly:this.props.readonly}))),r.a.createElement("img",{src:this.state.form.imageUri,style:{maxWidth:"100%",maxHeight:"200px"},className:"mt-3"}),this.state.imageError.length>0&&r.a.createElement("p",{className:"text-danger font-13 mb-0"},this.state.imageError)),r.a.createElement("div",{className:"col-12 mt-3"},r.a.createElement("label",null,"Description *"),r.a.createElement("textarea",{className:"form-control",rows:5,style:{minHeight:"100px"},value:this.state.form.description,onChange:this.updateDescription,readOnly:this.props.readonly}),this.state.descriptionError.length>0&&r.a.createElement("p",{className:"text-danger font-13 mb-0"},this.state.descriptionError))))}}]),t}(r.a.PureComponent);var ye=Object(F.b)(function(e){return{title:e.newItemState.title,description:e.newItemState.description,price:e.newItemState.unitPrice,imageUri:e.newItemState.imageUri}},function(e){return{updateNewItemForm:function(t,a,n,r){return e(function(e,t,a,n){return{type:D,title:e,price:t,description:a,imageUri:n}}(t,a,n,r))},fetchAllItems:function(){return e(C())}}})(function(e){var t=r.a.createRef(),a=Object(n.useState)(!1),c=Object(se.a)(a,2),i=c[0],s=c[1];function l(){return(l=Object(x.a)(S.a.mark(function a(){var n;return S.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.current){a.next=3;break}if(t.current.validateForm()){a.next=3;break}return a.abrupt("return");case 3:return a.next=5,I()({icon:"warning",title:"Are you sure?",text:"This will list a new item in the store.",dangerMode:!0,buttons:["Cancel","Create"]});case 5:if(!0!==a.sent){a.next=11;break}return s(!0),n="".concat(N(),"/items"),a.next=11,fetch(n,{method:"POST",body:JSON.stringify({name:e.title,description:e.description,price:e.price||0,imageUri:e.imageUri}),headers:{"Content-Type":"application/json"}}).then(function(){var t=Object(x.a)(S.a.mark(function t(a){var n;return S.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(201!==a.status){t.next=6;break}e.updateNewItemForm("",0,"",""),e.fetchAllItems(),pe.push("/item-management"),t.next=10;break;case 6:return t.next=8,a.text();case 8:n=t.sent,j("Couldn't save item",n);case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){j("Couldn't save item",e)}).finally(function(){s(!1)});case 11:case"end":return a.stop()}},a)}))).apply(this,arguments)}return r.a.createElement("div",{className:"card-box"},r.a.createElement(ce,{title:"NEW ITEM"}),r.a.createElement(ge,{ref:t,form:{imageUri:e.imageUri,description:e.description,title:e.title,unitPrice:e.price||0,itemId:-1},formChanged:function(t,a,n,r){e.updateNewItemForm(t,n,a,r)},readonly:i}),r.a.createElement("button",{className:"btn btn-info mt-3",onClick:function(){return l.apply(this,arguments)},disabled:i},i?"Saving...":"Save Item"))}),Se=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).formRef=r.a.createRef(),a.deleteItem=Object(x.a)(S.a.mark(function e(){var t;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I()({icon:"warning",title:"Are you sure?",text:"This will permanently delete this item",dangerMode:!0,buttons:["Cancel","Delete"]});case 2:if(!0!==e.sent){e.next=8;break}return a.setState({isDeleting:!0}),t="".concat(N(),"/items/").concat(a.props.match.params.itemId),e.next=8,fetch(t,{method:"DELETE"}).then(function(){var e=Object(x.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=5;break}a.props.fetchAllListings(),pe.push("/item-management"),e.next=9;break;case 5:return e.next=7,t.text();case 7:n=e.sent,j("Couldn't save item",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("Couldn't save item",e)}).finally(function(){a.setState({isDeleting:!1})});case 8:case"end":return e.stop()}},e)})),a.updateItem=Object(x.a)(S.a.mark(function e(){var t;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.formRef.current||!a.formRef.current.validateForm()){e.next=9;break}return e.next=3,I()({icon:"warning",title:"Are you sure?",text:"This will update the selected item",dangerMode:!0,buttons:["Cancel","Update"]});case 3:if(!0!==e.sent){e.next=9;break}return a.setState({isSaving:!0}),t="".concat(N(),"/items/").concat(a.props.match.params.itemId),e.next=9,fetch(t,{method:"PUT",body:JSON.stringify({name:a.state.form.title,description:a.state.form.description,price:a.state.form.unitPrice||0,imageUri:a.state.form.imageUri}),headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(x.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=5;break}a.props.fetchAllListings(),pe.push("/item-management"),e.next=9;break;case 5:return e.next=7,t.text();case 7:n=e.sent,j("Couldn't save item",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("Couldn't save item",e)}).finally(function(){a.setState({isSaving:!1})});case 9:case"end":return e.stop()}},e)})),a.handleFormChange=function(e,t,n,r){a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{title:e,description:t,imageUri:r,unitPrice:n.toString()})}))},a.state={form:{description:"",imageUri:"",title:"",unitPrice:""},isEditing:!1,isSaving:!1,isDeleting:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.props.match.params.itemId!==e.match.params.itemId&&this.setState({isEditing:!1,isSaving:!1,isDeleting:!1})}},{key:"render",value:function(){var e=this,t=this.props.items.find(function(t){return t.itemId.toString()===e.props.match.params.itemId});return null==t?(pe.push("/item-management"),r.a.createElement(r.a.Fragment,null)):r.a.createElement("div",{className:"card-box"},r.a.createElement(ce,{title:"EDIT ITEM (ITEM ID: "+this.props.match.params.itemId+")"}),r.a.createElement(ge,{ref:this.formRef,form:{itemId:t.itemId,description:t.description,title:t.name,unitPrice:t.price,imageUri:t.imageUri},formChanged:this.handleFormChange,readonly:!this.state.isEditing||this.state.isSaving}),this.state.isEditing&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn btn-info mt-3",onClick:this.updateItem,disabled:this.state.isSaving},this.state.isSaving?"Saving...":"Update Item")),!this.state.isEditing&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn btn-primary mt-3",onClick:function(){return e.setState({isEditing:!0})}},"Edit Item"),r.a.createElement("button",{className:"btn btn-danger mt-3 ml-3",onClick:this.deleteItem},"Delete Item")))}}]),t}(r.a.PureComponent);var xe=Object(F.b)(function(e){return{items:e.listingsState.listings}},function(e){return{fetchAllListings:function(){return e(C())}}})(Se);var Ne=Object(F.b)(function(e){return{listings:e.listingsState.listings,isFetchingListings:e.listingsState.isFetchingListings}},function(e){return{fetchAllListings:function(){return e(C())}}})(function(e){return Object(n.useEffect)(function(){e.fetchAllListings()},[]),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-6 col-xl-8"},r.a.createElement("div",{className:"card-box"},r.a.createElement(ce,{title:"ITEM MANAGEMENT"}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement(f.a,{to:"/item-management/new",className:"btn btn-info mt-3"},"New Item"),r.a.createElement("button",{className:"btn btn-secondary mt-3 float-right",onClick:e.fetchAllListings},"Refresh"))),r.a.createElement(ve,{items:e.listings.filter(function(e){return"Voucher"!==e.itemType}).map(function(e){return{itemId:e.itemId,name:e.name,price:e.price}})}))),r.a.createElement("div",{className:"col-lg-6 col-xl-4"},r.a.createElement(E.d,null,r.a.createElement(E.b,{exact:!0,path:"/item-management/new",component:ye}),r.a.createElement(E.b,{path:"/item-management/edit/:itemId",component:xe}))))});function Oe(e){return r.a.createElement("tr",null,r.a.createElement("td",null,e.voucherId),r.a.createElement("td",null,e.code),r.a.createElement("td",null,e.value.toFixed(2)),r.a.createElement("td",null,e.minBasketPrice.toFixed(2)),r.a.createElement("td",null,e.itemSubset),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-danger",onClick:function(){return e.deleteVoucher(e.voucherId)}},"Delete")))}var Ie=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).saveOfferVoucher=Object(x.a)(S.a.mark(function e(){var t,n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!0,(0===a.state.code.length||a.state.code.length>20)&&(a.setState({codeError:"Code must be between 1 and 20 characters"}),t=!1),null==a.props.subsets.find(function(e){return e.name===a.state.itemSubset})&&a.state.itemSubset.length>0&&(a.setState({subsetError:"Not a valid subset"}),t=!1),parseFloat(a.state.value)<=0&&(a.setState({valueError:"Value must be greater than 0"}),t=!1),!t){e.next=14;break}return e.next=8,I()({icon:"warning",title:"Are you sure?",text:"This will create a new voucher",dangerMode:!0,buttons:["Cancel","Create"]});case 8:if(e.sent){e.next=11;break}return e.abrupt("return");case 11:a.setState({isSaving:!0}),n="".concat(N(),"/vouchers/offer"),fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({minPriceToApply:a.state.minBasketPrice,value:a.state.value,code:a.state.code,voucherType:"Offer",subsetGroup:{name:a.state.itemSubset}})}).then(function(){var e=Object(x.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(201!==t.status){e.next=5;break}a.props.fetchVouchers(),a.setState({code:"",itemSubset:"",minBasketPrice:"",value:""}),e.next=9;break;case 5:return e.next=7,t.text();case 7:n=e.sent,j("Failed to save voucher",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("Failed to save voucher",e)}).finally(function(){a.setState({isSaving:!1})});case 14:case"end":return e.stop()}},e)})),a.onSubsetChange=function(e){a.setState({itemSubset:e.target.value,subsetError:""})},a.updateCode=function(e){a.setState({code:e.target.value,codeError:""})},a.updateValue=function(e){a.setState({value:e.target.value,valueError:""})},a.onBlurValue=function(e){var t=(e.target.validity.valid&&e.target.value.length>0?parseFloat(e.target.value):0).toFixed(2);a.setState(Object(P.a)({},a.state,{value:t,valueError:""}))},a.updateMinBasketPrice=function(e){a.setState({minBasketPrice:e.target.value,minBasketPriceError:""})},a.onBlurMinBasketPrice=function(e){var t=(e.target.validity.valid&&e.target.value.length>0?parseFloat(e.target.value):0).toFixed(2);a.setState(Object(P.a)({},a.state,{minBasketPrice:t,minBasketPriceError:""}))},a.deleteVoucher=function(){var e=Object(x.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I()({icon:"warning",title:"Are you sure?",text:"This will permanently delete this voucher",dangerMode:!0,buttons:["Cancel","Delete"]});case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:n="".concat(N(),"/vouchers/").concat(t),fetch(n,{method:"DELETE"}).then(function(){var e=Object(x.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=4;break}a.props.fetchVouchers(),e.next=8;break;case 4:return e.next=6,t.text();case 6:n=e.sent,j("Failed to delete voucher",n);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("Failed to delete voucher",e)});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.state={code:"",value:"0",minBasketPrice:"0",itemSubset:"",codeError:"",minBasketPriceError:"",valueError:"",subsetError:"",isSaving:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"-"),r.a.createElement("td",null,r.a.createElement("input",{type:"text",className:"form-control",style:{maxWidth:"250px"},value:this.state.code,onChange:this.updateCode}),this.state.codeError.length>0&&r.a.createElement("p",{className:"text-danger font-13 mb-0"},this.state.codeError)),r.a.createElement("td",null,r.a.createElement("input",{type:"number",className:"form-control",style:{maxWidth:"250px"},value:this.state.value,onChange:this.updateValue,onBlur:this.onBlurValue}),this.state.valueError.length>0&&r.a.createElement("p",{className:"text-danger font-13 mb-0"},this.state.valueError)),r.a.createElement("td",null,r.a.createElement("input",{type:"number",className:"form-control",style:{maxWidth:"250px"},value:this.state.minBasketPrice,onChange:this.updateMinBasketPrice,onBlur:this.onBlurMinBasketPrice}),this.state.minBasketPriceError.length>0&&r.a.createElement("p",{className:"text-danger font-13 mb-0"},this.state.minBasketPriceError)),r.a.createElement("td",null,r.a.createElement("input",{type:"text",className:"form-control",style:{maxWidth:"250px"},list:"offerVoucherManagementTableList",onChange:this.onSubsetChange,value:this.state.itemSubset}),this.state.subsetError.length>0&&r.a.createElement("p",{className:"text-danger font-13 mb-0"},this.state.subsetError),r.a.createElement("datalist",{id:"offerVoucherManagementTableList"},this.props.subsets.map(function(e,t){return r.a.createElement("option",{key:t,value:e.name},e.subsetId)}))),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-info",onClick:this.saveOfferVoucher},this.state.isSaving?"Saving...":"Save Voucher"))),this.props.isLoadingVouchers&&r.a.createElement("tr",null,r.a.createElement("td",{colSpan:6},r.a.createElement(T,null))),this.props.offerVouchers.map(function(t,a){return r.a.createElement(Oe,{code:t.code,key:a,minBasketPrice:t.minPriceToApply,voucherId:t.voucherId,deleteVoucher:e.deleteVoucher,value:t.value,itemSubset:t.subsetGroup?t.subsetGroup.name:"-"})}))}}]),t}(r.a.PureComponent);var je=Object(F.b)(function(e){return{offerVouchers:e.voucherState.vouchers.offerVouchers,subsets:e.subsetState.subsets,isFetchingVouchers:e.voucherState.isFetchingVouchers}},function(e){return{fetchVouchers:function(){return e(_())},fetchSubsets:function(){return e(Q())}}})(function(e){return Object(n.useEffect)(function(){e.fetchSubsets()},[]),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"table-responsive"},r.a.createElement("table",{className:"table table-hover"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Voucher Id"),r.a.createElement("th",null,"Code"),r.a.createElement("th",null,"Value (\xa3)"),r.a.createElement("th",null,"Min. Basket Price (\xa3)"),r.a.createElement("th",null,"Item Subset"),r.a.createElement("th",null))),r.a.createElement(Ie,{subsets:e.subsets,offerVouchers:e.offerVouchers,fetchVouchers:e.fetchVouchers,isLoadingVouchers:e.isFetchingVouchers})))))});function we(e){return r.a.createElement("tr",null,r.a.createElement("td",null,e.voucherId),r.a.createElement("td",null,e.code),r.a.createElement("td",null,e.value),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-danger",onClick:function(){return e.deleteVoucher(e.voucherId)}},"Delete")))}var ke=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).deleteVoucher=function(){var e=Object(x.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I()({icon:"warning",title:"Are you sure?",text:"This will permanently delete this voucher",dangerMode:!0,buttons:["Cancel","Delete"]});case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:n="".concat(N(),"/vouchers/").concat(t),fetch(n,{method:"DELETE"}).then(function(){var e=Object(x.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=4;break}a.props.fetchVouchers(),e.next=8;break;case 4:return e.next=6,t.text();case 6:n=e.sent,j("Failed to delete voucher",n);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("Failed to delete voucher",e)});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.saveGiftVoucher=Object(x.a)(S.a.mark(function e(){var t,n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!0,(0===a.state.code.length||a.state.code.length>20)&&(a.setState({codeError:"Code must be between 1 and 20 characters"}),t=!1),parseFloat(a.state.value)<=0&&(a.setState({valueError:"Value must be greater than 0"}),t=!1),!t){e.next=12;break}return e.next=6,I()({icon:"warning",title:"Are you sure?",text:"This will create a new voucher",dangerMode:!0,buttons:["Cancel","Create"]});case 6:if(e.sent){e.next=9;break}return e.abrupt("return");case 9:a.setState({isSaving:!0}),n="".concat(N(),"/vouchers/gift"),fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:a.state.value,code:a.state.code})}).then(function(){var e=Object(x.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(201!==t.status){e.next=5;break}a.props.fetchVouchers(),a.setState({code:"",value:""}),e.next=9;break;case 5:return e.next=7,t.text();case 7:n=e.sent,j("Failed to save voucher",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("Failed to save voucher",e)}).finally(function(){a.setState({isSaving:!1})});case 12:case"end":return e.stop()}},e)})),a.onBlurValue=function(e){var t=(e.target.validity.valid&&e.target.value.length>0?parseFloat(e.target.value):0).toFixed(2);a.setState(Object(P.a)({},a.state,{value:t,valueError:""}))},a.updateValue=function(e){a.setState({value:e.target.value,valueError:""})},a.updateCode=function(e){a.setState({code:e.target.value,codeError:""})},a.state={code:"",codeError:"",isSaving:!1,value:"0",valueError:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("tbody",null,this.props.isFetchingVouchers&&r.a.createElement("tr",null,r.a.createElement("td",{colSpan:4},r.a.createElement(T,null))),this.props.giftVouchers.map(function(t,a){return r.a.createElement(we,{code:t.code,deleteVoucher:e.deleteVoucher,key:a,value:t.value,voucherId:t.voucherId})}))}}]),t}(r.a.PureComponent);var Ce=Object(F.b)(function(e){return{giftVouchers:e.voucherState.vouchers.giftVouchers,isFetchingVouchers:e.voucherState.isFetchingVouchers}},function(e){return{fetchVouchers:function(){return e(_())}}})(function(e){return r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"table-responsive"},r.a.createElement("table",{className:"table table-hover"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Voucher Id"),r.a.createElement("th",null,"Code"),r.a.createElement("th",null,"Value (\xa3)"),r.a.createElement("th",null))),r.a.createElement(ke,{fetchVouchers:e.fetchVouchers,giftVouchers:e.giftVouchers,isFetchingVouchers:e.isFetchingVouchers})))))});var Fe=Object(F.b)(function(e){return{giftVouchers:e.voucherState.vouchers.giftVouchers,offerVouchers:e.voucherState.vouchers.offerVouchers}},function(e){return{fetchAllVouchers:function(){return e(_())}}})(function(e){return Object(n.useEffect)(function(){e.fetchAllVouchers()},[]),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"card-box"},r.a.createElement("ul",{className:"nav nav-tabs tabs-bordered"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(f.b,{to:"/voucher-management/offer",className:"nav-link"},"OFFER VOUCHERS")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(f.b,{to:"/voucher-management/gift",className:"nav-link"},"GIFT VOUCHERS"))),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-12"},r.a.createElement("button",{className:"btn btn-secondary",onClick:e.fetchAllVouchers},"Refresh"))),r.a.createElement(E.d,null,r.a.createElement(E.b,{exact:!0,path:"/voucher-management/offer",component:je}),r.a.createElement(E.b,{exact:!0,path:"/voucher-management/gift",component:Ce})))))});function Te(e){return r.a.createElement("tr",{onClick:function(){return pe.push("/subset-management/edit/".concat(e.subsetId))},style:{cursor:"pointer"}},r.a.createElement("td",null,e.subsetId),r.a.createElement("td",null,e.name),r.a.createElement("td",null,0===e.items.length?"-":e.items.join(", ")))}var Ve=function(e){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"table-responsive mt-3"},r.a.createElement("table",{className:"table table-hover"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Subset Id"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Items"))),r.a.createElement("tbody",null,e.subsets.map(function(e,t){return r.a.createElement(Te,{subsetId:e.subsetId,key:t,name:e.name,items:e.items.map(function(e){return e.name})})}))))))},Pe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).validateForm=function(){var e=!0;return(0===a.state.form.name.length||a.state.form.name.length>50)&&(a.setState({nameError:"Name must be between 1 and 50 characters"}),e=!1),e},a.addItem=function(e){var t=a.props.listings.find(function(t){return t.name===e.target.value});if(null!=t){var n=a.state.form.itemIds.slice();n.push(t.itemId),a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{itemIds:n})})),e.target.value="",a.props.formChanged(a.state.form.name,n)}},a.removeItem=function(e){var t=a.state.form.itemIds.slice().filter(function(t){return t!==e});a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{itemIds:t})})),a.props.formChanged(a.state.form.name,t)},a.updateForm=function(){a.props.formChanged(a.state.form.name,a.state.form.itemIds)},a.updateName=function(e){a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{name:e.target.value}),nameError:""}))},a.state={form:{itemIds:e.form.itemIds,name:e.form.name},nameError:""},a.removeItem.bind(Object(Ee.a)(Object(Ee.a)(a))),a.addItem.bind(Object(Ee.a)(Object(Ee.a)(a))),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.props.form.subsetId!==e.form.subsetId&&this.setState({form:{name:e.form.name,itemIds:e.form.itemIds},nameError:""})}},{key:"render",value:function(){var e=this;return r.a.createElement("form",{className:"mt-3",onBlur:this.updateForm},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("label",null,"Name *"),r.a.createElement("input",{type:"text",maxLength:50,className:"form-control",readOnly:this.props.readonly,value:this.state.form.name,style:{maxWidth:"350px"},onChange:this.updateName}),this.state.nameError.length>0&&r.a.createElement("p",{className:"text-danger font-13 mb-0"},this.state.nameError)),r.a.createElement("div",{className:"col-12 mt-3"},r.a.createElement("label",null,"Items"),r.a.createElement("input",{type:"text",className:"form-control",readOnly:this.props.readonly,style:{maxWidth:"350px"},list:"subsetItemsDl",onChange:this.addItem}),r.a.createElement("datalist",{id:"subsetItemsDl"},this.props.listings.filter(function(t){return-1===e.props.form.itemIds.indexOf(t.itemId)}).map(function(e,t){return r.a.createElement("option",{key:t,value:e.name},e.itemId)})),r.a.createElement("table",{className:"table table-sm mt-3",style:{maxWidth:"350px"}},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Item Id"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null))),r.a.createElement("tbody",null,this.props.listings.filter(function(t){return e.state.form.itemIds.indexOf(t.itemId)>-1}).map(function(t,a){return r.a.createElement("tr",{key:a},r.a.createElement("td",null,t.itemId),r.a.createElement("td",null,t.name),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-link",style:{padding:"0px"},disabled:e.props.readonly,onClick:function(){return e.removeItem(t.itemId)}},"Remove")))}))))))}}]),t}(r.a.PureComponent);var Ue=Object(F.b)(function(e){return{itemIds:e.subsetState.newSubsetState.itemIds,name:e.subsetState.newSubsetState.name,isFetchingItems:e.listingsState.isFetchingListings,listings:e.listingsState.listings}},function(e){return{fetchAllItems:function(){return e(C())},fetchAllSubsets:function(){return e(Q())},updateNewSubsetForm:function(t,a){return e(function(e,t){return{type:G,name:e,itemIds:t}}(t,a))}}})(function(e){var t=r.a.createRef(),a=Object(n.useState)(!1),c=Object(se.a)(a,2),i=c[0],s=c[1];function l(){return(l=Object(x.a)(S.a.mark(function a(){var n;return S.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.current){a.next=3;break}if(t.current.validateForm()){a.next=3;break}return a.abrupt("return");case 3:return a.next=5,I()({icon:"warning",title:"Are you sure?",text:"This will create a new item subset.",dangerMode:!0,buttons:["Cancel","Create"]});case 5:if(!0!==a.sent){a.next=11;break}return s(!0),n="".concat(N(),"/subsets"),a.next=11,fetch(n,{method:"POST",body:JSON.stringify({name:e.name,itemIds:e.itemIds}),headers:{"Content-Type":"application/json"}}).then(function(){var t=Object(x.a)(S.a.mark(function t(a){var n;return S.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(201!==a.status){t.next=6;break}e.updateNewSubsetForm("",[]),e.fetchAllSubsets(),pe.push("/subset-management"),t.next=10;break;case 6:return t.next=8,a.text();case 8:n=t.sent,j("Couldn't save item",n);case 10:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).catch(function(e){j("Couldn't save item",e)}).finally(function(){s(!1)});case 11:case"end":return a.stop()}},a)}))).apply(this,arguments)}return Object(n.useEffect)(function(){e.fetchAllItems()},[]),r.a.createElement("div",{className:"card-box"},r.a.createElement(ce,{title:"NEW SUBSET"}),r.a.createElement(Pe,{ref:t,form:{name:e.name,itemIds:e.itemIds,subsetId:-1},listings:e.listings,isFetchingListings:e.isFetchingItems,formChanged:function(t,a){e.updateNewSubsetForm(t,a)},readonly:i}),r.a.createElement("button",{className:"btn btn-info mt-3",disabled:i,onClick:function(){return l.apply(this,arguments)}},i?"Saving...":"Save Subset"))}),Ae=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).formRef=r.a.createRef(),a.deleteSubset=Object(x.a)(S.a.mark(function e(){var t;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I()({icon:"warning",title:"Are you sure?",text:"This will permanently delete this subset",dangerMode:!0,buttons:["Cancel","Delete"]});case 2:if(!0!==e.sent){e.next=8;break}return a.setState({isDeleting:!0}),t="".concat(N(),"/subsets/").concat(a.props.match.params.subsetId),e.next=8,fetch(t,{method:"DELETE"}).then(function(){var e=Object(x.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=5;break}a.props.fetchAllSubsets(),pe.push("/subset-management"),e.next=9;break;case 5:return e.next=7,t.text();case 7:n=e.sent,j("Couldn't delete subset",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("Couldn't delete subset",e)}).finally(function(){a.setState({isDeleting:!1})});case 8:case"end":return e.stop()}},e)})),a.updateSubset=Object(x.a)(S.a.mark(function e(){var t;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.formRef.current||!a.formRef.current.validateForm()){e.next=9;break}return e.next=3,I()({icon:"warning",title:"Are you sure?",text:"This will update the selected subset",dangerMode:!0,buttons:["Cancel","Update"]});case 3:if(!0!==e.sent){e.next=9;break}return a.setState({isSaving:!0}),t="".concat(N(),"/subsets/").concat(a.props.match.params.subsetId),e.next=9,fetch(t,{method:"PUT",body:JSON.stringify({name:a.state.form.name,itemIds:a.state.form.itemIds}),headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(x.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=5;break}a.props.fetchAllSubsets(),pe.push("/subset-management"),e.next=9;break;case 5:return e.next=7,t.text();case 7:n=e.sent,j("Couldn't save subset",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){j("Couldn't save subset",e)}).finally(function(){a.setState({isSaving:!1})});case 9:case"end":return e.stop()}},e)})),a.handleFormChange=function(e,t){a.setState(Object(P.a)({},a.state,{form:Object(P.a)({},a.state.form,{name:e,itemIds:t})}))},a.state={form:{itemIds:[],name:""},isDeleting:!1,isEditing:!1,isSaving:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchAllListings()}},{key:"componentWillReceiveProps",value:function(e){this.props.match.params.subsetId!==e.match.params.subsetId&&this.setState({isEditing:!1,isSaving:!1,isDeleting:!1})}},{key:"render",value:function(){var e=this,t=this.props.subsets.find(function(t){return t.subsetId.toString()===e.props.match.params.subsetId});return null==t?(pe.push("/subset-management"),r.a.createElement(r.a.Fragment,null)):r.a.createElement("div",{className:"card-box"},r.a.createElement(ce,{title:"EDIT SUBSET (SUBSET ID: "+this.props.match.params.subsetId+")"}),r.a.createElement(Pe,{ref:this.formRef,isFetchingListings:this.props.isFetchingListings,listings:this.props.listings,form:{itemIds:t.items.map(function(e){return e.itemId}),name:t.name,subsetId:t.subsetId},formChanged:this.handleFormChange,readonly:!this.state.isEditing||this.state.isSaving}),this.state.isEditing&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn btn-info mt-3",onClick:this.updateSubset,disabled:this.state.isSaving},this.state.isSaving?"Saving...":"Update Subset")),!this.state.isEditing&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn btn-primary mt-3",onClick:function(){return e.setState({isEditing:!0})}},"Edit Subset"),r.a.createElement("button",{className:"btn btn-danger mt-3 ml-3",onClick:this.deleteSubset},"Delete Subset")))}}]),t}(r.a.PureComponent);var Le=Object(F.b)(function(e){return{isFetchingListings:e.listingsState.isFetchingListings,listings:e.listingsState.listings,subsets:e.subsetState.subsets}},function(e){return{fetchAllListings:function(){return e(C())},fetchAllSubsets:function(){return e(Q())}}})(Ae);var Be=Object(F.b)(function(e){return{isFetchingSubsets:e.subsetState.isFetchingSubsets,subsets:e.subsetState.subsets}},function(e){return{fetchAllSubsets:function(){return e(Q())}}})(function(e){return Object(n.useEffect)(function(){e.fetchAllSubsets()},[]),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-xl-8 col-lg-6"},r.a.createElement("div",{className:"card-box"},r.a.createElement(ce,{title:"ITEM SUBSETS"}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement(f.a,{to:"/subset-management/new",className:"btn btn-info mt-3"},"New Subset"),r.a.createElement("button",{className:"btn btn-secondary mt-3 float-right",onClick:e.fetchAllSubsets},"Refresh"))),r.a.createElement(Ve,{subsets:e.subsets}))),r.a.createElement("div",{className:"col-lg-6 col-xl-4"},r.a.createElement(E.d,null,r.a.createElement(E.b,{exact:!0,path:"/subset-management/new",component:Ue}),r.a.createElement(E.b,{path:"/subset-management/edit/:subsetId",component:Le}))))}),De=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=function(){var e=Z.get(ee);return null==e?[]:JSON.parse(e)}();this.props.setCart(e)}},{key:"render",value:function(){return r.a.createElement("div",{id:"wrapper"},r.a.createElement(b,null),r.a.createElement("div",{className:"content-page"},r.a.createElement("div",{className:"content",style:{marginTop:"0px"}},r.a.createElement("div",{className:"container-fluid"},r.a.createElement(v,null),r.a.createElement(E.d,null,r.a.createElement(E.b,{path:"/subset-management",component:Be}),r.a.createElement(E.b,{path:"/item-management",component:Ne}),r.a.createElement(E.a,{exact:!0,from:"/voucher-management",to:"/voucher-management/offer"}),r.a.createElement(E.b,{path:"/voucher-management",component:Fe}),r.a.createElement(E.b,{exact:!0,path:"/checkout",component:fe}),r.a.createElement(E.b,{exact:!0,path:"/",component:me}))))))}}]),t}(n.Component);var Me=Object(F.b)(null,function(e){return{setCart:function(t){return e(ne(t))}}})(De);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(F.a,{store:X},r.a.createElement(E.c,{history:pe},r.a.createElement(Me,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[40,1,2]]]);
//# sourceMappingURL=main.dfc06f1f.chunk.js.map